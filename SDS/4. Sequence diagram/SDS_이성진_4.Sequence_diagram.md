
## 🔄 4. Sequence Diagram

> 모든 Sequence Diagram은 특정 Use Case와 대응되며, 시나리오 흐름을 따른다.  
> 클래스 다이어그램의 관계 및 operation과 일치하며, 시스템 객체 간 메시지 교환 과정을 표현한다.

---

### 🧍‍♂️ 4.1 회원 기능 Sequence Diagram

#### 🔐 4.1.1 로그인
1. 사용자가 로그인 요청을 전송  
2. `MemberController` → `MemberService` 로직 수행  
3. `MemberRepository`에서 ID 조회  
4. 비밀번호 불일치 시 오류 반환  
5. 일치 시 `JWT_Handler`를 통해 인증 토큰 생성  
6. `HttpOnly Cookie`에 토큰 저장 후 로그인 성공 응답  

#### 🧾 4.1.2 회원등록
1. 사용자 요청 → `MemberController`  
2. `MemberService`에서 아이디 중복 확인  
3. 중복 시 실패 응답  
4. 비밀번호 암호화 후 DB 저장  
5. 성공 시 회원가입 완료 응답 반환  

#### ✏️ 4.1.3 프로필 수정
1. 사용자 요청 → `MemberController` → `MemberUpdateService`  
2. 사용자 정보 조회  
3. 데이터 수정(프로필 이미지, 자기소개 등)  
4. 트랜잭션 종료 시 DB 업데이트  
5. 수정 완료 응답 반환  

#### 🔑 4.1.4 비밀번호 변경
1. 사용자 요청 → `MemberController`  
2. 현재 비밀번호 검증 → 불일치 시 실패  
3. 새 비밀번호 일치 여부 확인  
4. 암호화 후 DB 업데이트  
5. 성공 시 변경 완료 응답  

#### 📧 4.1.5 이메일 변경
1. 비밀번호 검증 후 통과 시  
2. 새 이메일 중복 확인  
3. 중복 시 실패, 통과 시 DB 업데이트  
4. 성공 응답 반환  

#### 🗑️ 4.1.6 계정 삭제
1. 사용자 비밀번호 확인  
2. 불일치 시 실패 응답  
3. 일치 시 `MemberRepository.delete(user)` 호출  
4. 계정 삭제 성공 응답 반환  

---

### 💬 4.2 오픈 스터디 Sequence Diagram

#### 🏠 4.2.1 방 생성
1. 사용자 요청 → `OpenStudyRoomController`  
2. 중복 참여 여부 검사  
3. 자동 삭제 타이머 설정  
4. 방 및 첫 참여자 DB 저장  
5. 성공 응답 반환  

#### 📋 4.2.2 방 목록 조회
1. 요청 → `OpenStudyRoomController`  
2. DB에서 활성 방 목록 조회  
3. DTO로 변환 후 응답  

#### 🙋 4.2.3 방 참여
1. 기존 참여 여부 검증  
2. 방 상태 및 인원 확인  
3. 참여자 등록  
4. 인원 2명 이상 시 자동 삭제 예약 취소  

#### ⏱️ 4.2.4 방 자동 정리(Scheduler)
1. 5분 이상 혼자 있는 방 자동 삭제  
2. 삭제 예약 시간 경과 시 추가 삭제 수행  

---

### 👥 4.3 그룹 스터디 Sequence Diagram

#### ➕ 4.3.1 그룹 생성
1. 그룹 이름 검증  
2. `GroupRepository`에 저장  
3. DTO 변환 후 성공 응답  

#### 👤 4.3.2 멤버 추가
1. 그룹 존재 및 중복 멤버 여부 확인  
2. 중복 시 실패, 신규면 저장  
3. 성공 응답 반환  

#### 🚫 4.3.3 멤버 추방
1. 리더 권한 및 자기추방 여부 검증  
2. 존재 확인 후 DB 삭제  
3. 성공 시 응답 반환  

#### ❌ 4.3.4 그룹 삭제
1. 그룹 존재 및 리더 권한 확인  
2. 멤버 수 1명 초과 시 실패  
3. 삭제 성공 시 응답 반환  

#### 🏗️ 4.3.5 스터디방 생성
1. 그룹 존재 및 요청자 멤버 여부 확인  
2. 유효성 검증 후 방 저장  
3. 생성자를 첫 참여자로 등록  
4. 성공 응답 반환  

#### 🚪 4.3.6 스터디방 입장
1. 방 존재, 멤버 여부, 중복 입장 여부 확인  
2. 인원수 및 상태 검증  
3. 참여자 등록 후 응답 반환  

#### 🏃 4.3.7 스터디방 퇴장
1. 존재 및 참여 여부 확인  
2. 인원수 감소, 참여 기록 삭제  
3. 성공 응답 반환  

#### 🔚 4.3.8 스터디방 종료
1. 방 상태 ENDED로 변경  
2. 모든 참여 기록 삭제  
3. 성공 응답 반환  

#### 🔍 4.3.9 스터디방 조회
1. ID 기반 그룹 조회  
2. DTO 변환 후 응답  
> 같은 구조로 그룹 멤버/스터디방/참여자 조회도 동일하게 처리  

---

### ✅ 4.4 체크리스트 Sequence Diagram

#### 🗒️ 4.4.1 체크리스트 생성
1. 입력값 유효성 검사  
2. 사용자 인증 확인  
3. DB 저장 후 DTO 반환  

#### ✏️ 4.4.2 체크리스트 수정
1. 항목 존재 및 권한 확인  
2. 내용 업데이트 후 DB 저장  
3. 성공 응답 반환  

#### 🔎 4.4.3 체크리스트 조회
1. 선택 날짜 기준 조회  
2. DTO 리스트 변환 후 응답  

#### 🗓️ 4.4.4 월별 체크리스트 조회
1. 월별 존재 날짜 목록 조회  
2. 성공 응답 반환  

#### 🗑️ 4.4.5 체크리스트 삭제
1. 항목 존재 및 권한 검증  
2. DB 삭제 후 성공 응답  

#### ✅ 4.4.6 완료/미완료 상태 변경
1. 항목 존재 및 권한 검증  
2. 상태 반전 후 DB 업데이트  
3. 성공 응답 반환  
